!function(a){var b=a(".batch-update-menu");if(b.length){var c=b.closest("form"),d=c.find("[name=multiAction]");b.on("click",".field",function(b){var e=a(this).data("field");b.preventDefault(),d.val("batchUpdate"),c.append('<input type="hidden" name="field" value="'+e+'">'),c.submit()})}}(presideJQuery),function(a){a.fn.dataListingTable=function(){return this.each(function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=a(this),r=q.data(),s=q.attr("id"),t=400,u=r.objectName||cfrequest.objectName||"",v=r.datasourceUrl||cfrequest.datasourceUrl||buildAjaxLink("dataManager.getObjectRecordsForAjaxDataTables",{id:u}),w=r.isMultilingual||cfrequest.isMultilingual||!1,x=r.draftsEnabled||cfrequest.draftsEnabled||!1,u=r.objectName||cfrequest.objectName||"",y=r.objectTitle||cfrequest.objectTitle||i18n.translateResource("preside-objects."+u+":title").toLowerCase(),z=r.allowSearch||cfrequest.allowSearch,A=r.allowFilter||cfrequest.allowFilter,B=r.allowDataExport||cfrequest.allowDataExport,C=r.favouritesUrl||cfrequest.favouritesUrl||buildAjaxLink("rulesEngine.ajaxDataGridFavourites",{objectName:u}),D=void 0===r.clickableRows?void 0===cfrequest.clickableRows||cfrequest.clickableRows:r.clickableRows,E=void 0===r.useMultiActions?void 0===cfrequest.useMultiActions||cfrequest.useMultiActions:r.useMultiActions,F=a("#"+s+"-filter"),G=a("#"+s+"-favourites");c=function(){var c,d,e,h=q.find("thead > tr > th"),i=[],j=[],k=1;for(E&&i.push({sClass:"center",bSortable:!1,mData:"_checkbox",sWidth:"5em"}),x&&k++,w&&k++,d=E?1:0;d<h.length-k;d++)e=a(h.get(d)),i.push({mData:a(h.get(d)).data("field")}),void 0!==e.data("defaultSortOrder")&&j.push([d,e.data("defaultSortOrder")]);for(x&&i.push({bSortable:!1,mData:"_status",sWidth:"15em"}),w&&i.push({bSortable:!1,mData:"_translateStatus",sWidth:"12em"}),i.push({sClass:"center",bSortable:!1,mData:"_options",sWidth:"9em"}),e=a(h.get(h.length-1)),d=0;d<h.length;d++)e=a(h.get(d)),void 0!==e.data("class")&&(i[d].sClass=e.data("class")),void 0!==e.data("sortable")&&(i[d].bSortable=e.data("sortable")),void 0!==e.data("width")&&(i[d].sWidth=e.data("width"));c=A?"<'well'fr<'clearfix'>><'dataTables_pagination top'<'pull-left'i><'pull-left'l><'pull-right'p>>t<'dataTables_pagination bottom'<'pull-left'i><'pull-left'l><'pull-right'p>><'clearfix'>":"fr<'dataTables_pagination top'<'pull-left'i><'pull-left'l><'pull-right'p>>t<'dataTables_pagination bottom'<'pull-left'i><'pull-left'l><'pull-right'p><'clearfix'>",b=q.dataTable({aoColumns:i,aaSorting:j,bServerSide:!0,bProcessing:!0,bStateSave:!0,bFilter:z,bAutoWidth:!1,aLengthMenu:[5,10,25,50,100],sDom:c,sAjaxSource:v,fnRowCallback:function(b){$row=a(b),$row.attr("data-context-container","1"),D&&$row.addClass("clickable")},fnInitComplete:function(b){if(l=b,z){var c=a(b.aanFeatures.f[0]),d=c.find("input").first();d.addClass("data-table-search"),d.attr("data-global-key","s"),d.attr("autocomplete","off"),d.attr("placeholder",i18n.translateResource("cms:datamanager.search.placeholder",{data:[y],defaultValue:""})),d.wrap('<span class="input-icon"></span>'),d.after('<i class="fa fa-search data-table-search-icon"></i>'),d.keydown("down",function(a){var b=q.find(E?"tbody :checkbox:first":"tbody tr:first");b.length&&b.focus()})}A&&f(b),B&&g(b)},oLanguage:{oAria:{sSortAscending:i18n.translateResource("cms:datatables.sortAscending",{}),sSortDescending:i18n.translateResource("cms:datatables.sortDescending",{})},oPaginate:{sFirst:i18n.translateResource("cms:datatables.first",{data:[y],defaultValue:""}),sLast:i18n.translateResource("cms:datatables.last",{data:[y],defaultValue:""}),sNext:i18n.translateResource("cms:datatables.next",{data:[y],defaultValue:""}),sPrevious:i18n.translateResource("cms:datatables.previous",{data:[y],defaultValue:""})},sEmptyTable:i18n.translateResource("cms:datatables.emptyTable",{data:[y],defaultValue:""}),sInfo:i18n.translateResource("cms:datatables.info",{data:[y],defaultValue:""}),sInfoEmpty:i18n.translateResource("cms:datatables.infoEmpty",{data:[y],defaultValue:""}),sInfoFiltered:i18n.translateResource("cms:datatables.infoFiltered",{data:[y],defaultValue:""}),sInfoThousands:i18n.translateResource("cms:datatables.infoThousands",{data:[y],defaultValue:""}),sLengthMenu:i18n.translateResource("cms:datatables.lengthMenu",{data:[y],defaultValue:""}),sLoadingRecords:i18n.translateResource("cms:datatables.loadingRecords",{data:[y],defaultValue:""}),sProcessing:i18n.translateResource("cms:datatables.processing",{data:[y],defaultValue:""}),sZeroRecords:i18n.translateResource("cms:datatables.zeroRecords",{data:[y],defaultValue:""}),sSearch:"",sUrl:"",sInfoPostFix:""},fnServerParams:function(a){if(A){a.push({name:"sFilterExpression",value:F.find("[name=filter]").val()});var b=m();b&&b.length?a.push({name:"sSavedFilterExpressions",value:b}):a.push({name:"sSavedFilterExpressions",value:F.find("[name=filters]").val()})}},fnCookieCallback:function(a,b,c,d){return A&&(b.oFilter={filter:F.find("[name=filter]").val(),filters:F.find("[name=filters]").val(),favourites:m()}),a+"="+JSON.stringify(b)+"; expires="+c+"; path="+d}}).fnSetFilteringDelay(t)},d=function(){var b=q.find("th input:checkbox"),c=a("#multi-action-buttons");b.on("click",function(){q.find("tr > td:first-child input:checkbox").each(function(){this.checked=b.is(":checked"),this.checked?a(this).closest("tr").addClass("selected"):a(this).closest("tr").removeClass("selected")})}),c.data("hidden",!0),q.on("click","th input:checkbox,tbody tr > td:first-child input:checkbox",function(a){var d=q.find("tr > td:first-child input:checkbox:checked").length;d==q.find("td input:checkbox").length?b.prop("checked",!0):b.prop("checked",!1),o(!d),d&&c.data("hidden")?c.slideDown(250).data("hidden",!1).find("button").prop("disabled",!1):d||c.data("hidden")||c.slideUp(250).data("hidden",!0).find("button").prop("disabled",!0)})},setupMultiActionButtons=function(){var b=a("#multi-action-form"),c=b.find("[name=multiAction]");a("#multi-action-buttons button").click(function(b){c.val(a(this).attr("name"))})},o=function(b){q.find("tbody > tr").each(function(){b?a(this).attr("data-context-container","1"):a(this).removeAttr("data-context-container")})},e=function(){q.on("click","tbody :checkbox",function(){var b=a(this);b.closest("tr").toggleClass("selected",b.is(":checked"))})},f=function(c){var d=a(c.aanFeatures.f[0]),e=a('<h4 class="blue">'+i18n.translateResource("cms:datatables.simple.search.title")+"</h4>"),f=a('<a href="#" class="pull-right"><i class="fa fa-fw fa-filter"></i> '+i18n.translateResource("cms:datatables.show.advanced.filters")+"</a>");d.prepend(e),d.prepend(f),G.length&&(d.append(G),G.removeClass("hide"),G.on("click",".filter",function(c){c.preventDefault();var d=a(this);d.siblings(".filter");d.toggleClass("active").find(":focus").blur(),b.fnDraw()})),d.parent().append(F),F.hide().removeClass("hide").find(".well").removeClass("well"),f.on("click",j),F.on("click",".back-to-basic-search",k),F.on("click",".quick-filter-toggler",function(b){b.preventDefault(),a(this).find(".fa:first").toggleClass("fa-caret-right fa-caret-down")}),F.on("change",function(a){b.fnDraw(),F.find(".save-filter-btn").prop("disabled",!F.find("[name=filter]").val().length)}),h(F),null!==c.oLoadedState&&void 0!==c.oLoadedState.oFilter&&(c.oLoadedState.oFilter.filters.length||c.oLoadedState.oFilter.filter.length?i(c.oLoadedState.oFilter.filters,c.oLoadedState.oFilter.filter):c.oLoadedState.oFilter.favourites&&c.oLoadedState.oFilter.favourites.length&&n(c.oLoadedState.oFilter.favourites))},g=function(b){var c,d,e,f,g,h,i,j=b.aanFeatures.p,k=a(".object-listing-table-export"),n=(a(".object-listing-data-export-config-form"),a(".object-listing-data-export-button")),o=n.attr("href");for(c=0;c<j.length;c++)d=a(j[c]),d.prepend(k.html());e={title:i18n.translateResource("cms:dataexport.config.modal.title"),className:"full-screen-dialog",buttons:{cancel:{label:'<i class="fa fa-reply"></i> '+i18n.translateResource("cms:cancel.btn"),className:"btn-default"},ok:{label:'<i class="fa fa-download"></i> '+i18n.translateResource("cms:export.btn"),className:"btn-primary ok-button",callback:function(){return g()}}}},f={onLoad:function(a){i=a}},g=function(){var b,c,d,e=a(i.document).find(".export-config-form"),f=a(".object-listing-table-export-form"),g=a(l.aanFeatures.f[0]),h=e.serializeObject();A&&(h.filterExpressions=F.find("[name=filter]").val(),b=m(),b&&b.length?h.savedFilters=b:h.savedFilters=F.find("[name=filters]").val()),h.searchQuery=g.find("input.data-table-search").val();for(c in h)d=f.find("[name="+c+"]"),d.length||(d=a('<input type="hidden" name="'+c+'">'),f.append(d)),d.val(h[c]);return f.submit(),!0},h=new PresideIframeModal(o,"100%","100%",f,e),a(".object-listing-data-export-button").on("click",function(a){a.preventDefault(),h.open()}),k.remove()},p=function(){a.ajax({url:C,cache:!1,success:function(a){G.fadeOut(200,function(){G.html(a).fadeIn(200)})}})},m=function(){if(G.length){var b=[];return G.find(".filter.active").each(function(){b.push(a(this).data("filterId"))}),b.join(",")}return""},n=function(a){var b;if(G.length)for(a=a.split(","),G.find(".filter").removeClass("active"),b=0;b<a.length;b++)G.find(".filter[ data-filter-id='"+a[b]+"' ]").addClass("active")},i=function(a,b){var c=!1;if(a&&a.length){c=!0;var d,e=a.split(","),f=F.find("[name=filters]").data("uberSelect");for(d=0;d<e.length;d++)e[d].length&&f.select(e[d])}if(b&&b.length){c=!0;F.find("[name=filter]").data("conditionBuilder").load(b)}c&&(j(),b&&b.length||F.find(".quick-filter-toggler").click())},j=function(c){c&&c.preventDefault();var d=a(l.aanFeatures.f[0]);d.fadeOut(100,function(){d.find("input.data-table-search").val(""),n(""),b.fnFilter(""),F.fadeIn(100)})},k=function(c){c&&c.preventDefault();var d=a(l.aanFeatures.f[0]);F.fadeOut(100,function(){F.find("[name=filter]").data("conditionBuilder").clear(),F.find("[name=filters]").data("uberSelect").clear(),p(),b.fnDraw(),d.fadeIn(100)})},h=function(c){c.on("click",".save-filter-btn",function(d){d.preventDefault();var e,f,g,h=a(this).data("saveFormEndpoint")+encodeURIComponent(c.find("[name=filter]").val()),i=i18n.translateResource("cms:rulesEngine.save.filter.modal"),j={title:i,className:"filter-quick-save-modal",buttons:{cancel:{label:'<i class="fa fa-reply"></i> '+i18n.translateResource("cms:cancel.btn"),className:"btn-default"},add:{label:'<i class="fa fa-plus"></i> '+i18n.translateResource("cms:save.btn"),className:"btn-primary",callback:function(){return void 0===f.quickAdd||(f.quickAdd.submitForm(),!1)}}}},k={onLoad:function(a){a.presideObjectPicker=g,f=a},onShow:function(a,b){if(void 0!==b&&void 0!==b.quickAdd)return b.quickAdd.focusForm(),!1;a.on("hidden.bs.modal",function(b){a.remove()})}};g={addRecordToControl:function(a){c.find("[name=filter]").data("conditionBuilder").clear(),c.find("[name=filters]").data("uberSelect").select(a),c.find(".quick-filter-toggler").click(),b.fnDraw()},closeQuickAddDialog:function(){e.close(),a.gritter.add({title:i18n.translateResource("cms:info.notification.title"),text:i18n.translateResource("cms:rulesEngine.save.filter.confirmation.message"),class_name:"gritter-success",sticky:!1})}},e=new PresideIframeModal(h,"100%","100%",k,j),e.open()})},c(),e(),E&&(d(),setupMultiActionButtons())})},a(".object-listing-table").dataListingTable()}(presideJQuery);
//# sourceMappingURL=_object.min.map